<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../dependencies.html">
<dom-module id="work-canvas">
    <style>
    :host {
        width: 100%;
        height: 100%;
    }
    
    paper-material.main {
        height: 90%;
        width: 90%;
        margin: 20px;
    }
    
    *.unselectable {
        -moz-user-select: -moz-none;
        -khtml-user-select: none;
        -webkit-user-select: none;
        /*
     Introduced in IE 10.
     See http://ie.microsoft.com/testdrive/HTML5/msUserSelect/
   */
        -ms-user-select: none;
        user-select: none;
    }
    
    @media (max-width: 600px) {
        h1.paper-font-display1 {
            font-size: 24px;
        }
    }
    </style>
    <template>
        <paper-material id="mainCard" class="main" class="unselectable" elevation="3">
            <div class="card-content">
                <canvas style="position: absolute; left: 0; top: 0; z-index: 0;" id="gridCanvas" width="500" height="500"></canvas>
                <canvas style="position: absolute; left: 0; top: 0; z-index: 1;" id="arcCanvas" width="500" height="500"></canvas>
                <canvas style="position: absolute; left: 0; top: 0; z-index: 2;" id="canvas" on-mousemove="mousemove" height="500" width="500">
                    <div id="main">
                        <div class="blue draggable"></div>
                    </div>
                </canvas>
            </div>
        </paper-material>
    </template>
    <script>
    define(['invoiced-canvashelper', 'Victor'], function(ch, Victor) {
        Polymer({
            is: 'work-canvas',
            mousemove: function(evt) {
                var mousePos = ch.getMousePos(this.$.canvas, evt);
                ch.clearCanvas(this.$.canvas);
                var endVector = new Victor(mousePos.x, 0);
                var startVector = new Victor(mousePos.x, mousePos.y);
                ch.drawArrowHead(this.$.canvas, startVector, endVector);
                var endVector = new Victor(0, mousePos.y);
                var startVector = new Victor(mousePos.x, mousePos.y);
                ch.drawArrowHead(this.$.canvas, startVector, endVector);
            },
            attached: function(evt) {
                var gridCanvas = this.$.gridCanvas;
                var canvas = this.$.canvas;
                var arcCanvas = this.$.arcCanvas;
                ch.fitToContainer(canvas);
                ch.fitToContainer(gridCanvas);
                ch.fitToContainer(arcCanvas);
                ch.drawGrid(this.$.gridCanvas);


                window.addEventListener('resize', function(evt) {
                    ch.fitToContainer(canvas);
                    ch.fitToContainer(gridCanvas);
                    ch.fitToContainer(arcCanvas);
                    ch.drawGrid(gridCanvas);
                });
            }
        });
    });
    </script>
</dom-module>
